---
title: "Reproducible Research: Peer Assessment 1"

---
```{r global_options, include=FALSE}
library(knitr)
library(ggplot2)
library(scales)
library(lattice)
opts_chunk$set(echo=TRUE)       ## set global parameter for echo
options(scipen = 1, digits = 2) ## set rounding defaults
```

## Loading and preprocessing the data
```{r}
  ## set the working directory
  setwd("~/datasciencecoursera/RepData_PeerAssessment1/")

  ## read the full file
  file    = unz("activity.zip","activity.csv")
  classes = c("numeric","Date","numeric")
  full    = read.csv(file, colClasses = classes)

  ## consolidate date and time into a single variable
  full$dt = formatC(full$interval, width = 4, format = "d", flag = "0") 
  full$dt = paste(full$date,full$dt)
  full$dt = as.POSIXlt(full$dt,format="%Y-%m-%d %H%M")
  full    = full[,c(1,4)]

  ## subset data to complete cases (exclude NAs)
  d      = na.omit(full)
```

## What is mean total number of steps taken per day?

A visual presentation of the daily steps can be given by
```{r}
  dailysteps  = tapply(d$steps,as.Date(d$dt),sum)
  hist(dailysteps,main = "Histogram of Daily Steps", xlab = "Daily Steps")
  (meansteps   = mean(dailysteps))
  (medsteps    = median(dailysteps))
```

The median number of steps is `r round(meansteps,0)` and the median is `r round(medsteps,0)`.

## What is the average daily activity pattern?

```{r}
  ## make summary data frame
  avgpat = aggregate(d$steps,list(as.numeric(format(d$dt,"%H%M"))),mean)

  ## plot daily activity
  plot(avgpat, type="l", ylab="Number of Steps", xlab="",
       main="Average Number of Steps on a Given Day", axes = FALSE)
  axis(side = 1, at = c(0,600,1200,1800,2355),
       labels = c("midnight","6am","noon","6pm","midnight"))
  axis(side = 2)

  ## identify the highest point
  maxint = which.max(avgpat[[2]])
  x = avgpat[[1]][maxint]
  y = avgpat[[2]][maxint]
  maxtime = format(strptime(sprintf("%04d",x),"%H%M"),"%l:%M%p")
  points(x,y,col="red",pch=20)
  maxlab = paste(round(y,0),"steps,",maxtime)
  text(x,y,labels = maxlab, pos=4, col="red")
```

Average activity peaks at `r maxtime` with `r maxint` steps.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
