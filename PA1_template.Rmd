---
title: "Reproducible Research: Peer Assessment 1"

---
```{r global_options, include=FALSE}
library(knitr)
opts_chunk$set(echo=TRUE)       ## set global parameter for echo
options(scipen = 1, digits = 2) ## set rounding defaults
```

## Loading and preprocessing the data
```{r}
  ## set the working directory
  setwd("~/datasciencecoursera/RepData_PeerAssessment1/")

  ## read the full file
  file    = unz("activity.zip","activity.csv")
  classes = c("numeric","Date","numeric")
  full    = read.csv(file, colClasses = classes)

  ## consolidate date and time into a single variable
  full$dt = formatC(full$interval, width = 4, format = "d", flag = "0") 
  full$dt = paste(full$date,full$dt)
  full$dt = as.POSIXlt(full$dt,format="%Y-%m-%d %H%M")
  full    = full[,c(1,4)]

  ## subset data to complete cases (exclude NAs)
  df      = full[complete.cases(full),]
```

## What is mean total number of steps taken per day?

A visual presentation of the daily steps can be given by
```{r}
  dailysteps  = tapply(df$steps,as.Date(df$dt),sum)
  hist(dailysteps,main = "Histogram of Daily Steps")
  (meansteps   = mean(dailysteps))
  (medsteps    = median(dailysteps))
```

The median number of steps is `r round(meansteps,0)` and the median is `r round(medsteps,0)`.

## What is the average daily activity pattern?

```{r}
  avgpat  = tapply(df$steps,df$dt,mean)
  plot(avgpat,type="l",ylab="Average Number of Steps",
       xlab="Time Interval")
  maxint = which.max(avgpat)
  points(835,avgpat[835],col="red",pch=20)
  points(104,avgpat[104],col="blue",pch=20)
```

The code of of the interval with the average highest number of steps is `r maxint` 

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
